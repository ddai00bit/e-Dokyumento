monitoring is not defined
ReferenceError: monitoring is not defined
    at D:\Projects\PN DocMS\controllers\login.js:97:15
    at Array.forEach (<anonymous>)
    at D:\Projects\PN DocMS\controllers\login.js:92:17
    at FSReqCallback.oncomplete (fs.js:146:23)
ENOENT: no such file or directory, stat 'public/drive/n6b/CRA Checklist_Answers.docx'
Error: ENOENT: no such file or directory, stat 'public/drive/n6b/CRA Checklist_Answers.docx'
    at Object.statSync (fs.js:915:3)
    at D:\Projects\PN DocMS\controllers\dasmonitor.js:120:79
    at Array.sort (<anonymous>)
    at D:\Projects\PN DocMS\controllers\dasmonitor.js:119:17
    at FSReqCallback.oncomplete (fs.js:146:23)
req.body.branch.toUpperCase is not a function
TypeError: req.body.branch.toUpperCase is not a function
    at D:\Projects\PN DocMS\controllers\routeduty.js:171:29
    at FSReqCallback.oncomplete (fs.js:146:23)
req.body.branch.tostring is not a function
TypeError: req.body.branch.tostring is not a function
    at D:\Projects\PN DocMS\controllers\routeduty.js:171:29
    at FSReqCallback.oncomplete (fs.js:146:23)
EISDIR: illegal operation on a directory, read
Error: EISDIR: illegal operation on a directory, read
    at Object.readSync (fs.js:506:3)
    at tryReadSync (fs.js:331:20)
    at Object.readFileSync (fs.js:368:19)
    at Object.exports.convDoctoPDF (D:\Projects\PN DocMS\controllers\dochandle.js:11:25)
    at D:\Projects\PN DocMS\controllers\dasfileoperation.js:316:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:198:5
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
EISDIR: illegal operation on a directory, read
Error: EISDIR: illegal operation on a directory, read
    at Object.readSync (fs.js:506:3)
    at tryReadSync (fs.js:331:20)
    at Object.readFileSync (fs.js:368:19)
    at Object.exports.convDoctoPDF (D:\Projects\PN DocMS\controllers\dochandle.js:11:25)
    at D:\Projects\PN DocMS\controllers\dasfileoperation.js:298:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:220:5
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
Cannot read property 'enclosure' of null
TypeError: Cannot read property 'enclosure' of null
    at D:\Projects\PN DocMS\controllers\dastransact.js:85:21
    at D:\Projects\PN DocMS\controllers\dbhandle.js:359:15
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
Cannot read property 'enclosure' of null
TypeError: Cannot read property 'enclosure' of null
    at D:\Projects\PN DocMS\controllers\dastransact.js:84:21
    at D:\Projects\PN DocMS\controllers\dbhandle.js:359:15
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
Cannot read property 'enclusure' of null
TypeError: Cannot read property 'enclusure' of null
    at D:\Projects\PN DocMS\controllers\dastransact.js:84:25
    at D:\Projects\PN DocMS\controllers\dbhandle.js:359:15
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
Cannot read property 'enclosure' of null
TypeError: Cannot read property 'enclosure' of null
    at D:\Projects\PN DocMS\controllers\dastransact.js:84:25
    at D:\Projects\PN DocMS\controllers\dbhandle.js:359:15
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
Cannot read property 'enclosure' of null
TypeError: Cannot read property 'enclosure' of null
    at D:\Projects\PN DocMS\controllers\dastransact.js:84:25
    at D:\Projects\PN DocMS\controllers\dbhandle.js:359:15
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
Cannot read property 'enclosure' of null
TypeError: Cannot read property 'enclosure' of null
    at D:\Projects\PN DocMS\controllers\dastransact.js:84:25
    at D:\Projects\PN DocMS\controllers\dbhandle.js:359:15
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
EISDIR: illegal operation on a directory, read
Error: EISDIR: illegal operation on a directory, read
    at Object.readSync (fs.js:506:3)
    at tryReadSync (fs.js:331:20)
    at Object.readFileSync (fs.js:368:19)
    at Object.exports.convDoctoPDF (D:\Projects\PN DocMS\controllers\dochandle.js:11:25)
    at D:\Projects\PN DocMS\controllers\dasfileoperation.js:298:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:220:5
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
consol is not defined
ReferenceError: consol is not defined
    at D:\Projects\PN DocMS\controllers\dastransact.js:84:28
    at D:\Projects\PN DocMS\controllers\dbhandle.js:359:15
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
branches is not defined
ReferenceError: branches is not defined
    at Object.exports.routNoRefEncIncoming (D:\Projects\PN DocMS\controllers\routeduty.js:153:7)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:236:33
    at D:\Projects\PN DocMS\controllers\monitoring.js:169:85
    at D:\Projects\PN DocMS\controllers\dbhandle.js:220:5
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Unexpected token 'catch'
D:\Projects\PN DocMS\controllers\routeduty.js:257
  })catch((err)=>{});
    ^^^^^

SyntaxError: Unexpected token 'catch'
    at Module._compile (internal/modules/cjs/loader.js:895:18)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:995:10)
    at Module.load (internal/modules/cjs/loader.js:815:32)
    at Function.Module._load (internal/modules/cjs/loader.js:727:14)
    at Module.require (internal/modules/cjs/loader.js:852:19)
    at require (internal/modules/cjs/helpers.js:74:18)
    at module.exports (D:\Projects\PN DocMS\controllers\dasroyalty.js:6:19)
    at Domain.<anonymous> (D:\Projects\PN DocMS\index.js:44:8)
    at Domain.run (domain.js:363:14)
    at Timeout._onTimeout (D:\Projects\PN DocMS\index.js:24:5)
    at listOnTimeout (internal/timers.js:531:17)
    at processTimers (internal/timers.js:475:7)
Unexpected token 'catch'
D:\Projects\PN DocMS\controllers\routeduty.js:290
  })catch((err)=>{});
    ^^^^^

SyntaxError: Unexpected token 'catch'
    at Module._compile (internal/modules/cjs/loader.js:895:18)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:995:10)
    at Module.load (internal/modules/cjs/loader.js:815:32)
    at Function.Module._load (internal/modules/cjs/loader.js:727:14)
    at Module.require (internal/modules/cjs/loader.js:852:19)
    at require (internal/modules/cjs/helpers.js:74:18)
    at module.exports (D:\Projects\PN DocMS\controllers\dasroyalty.js:6:19)
    at Domain.<anonymous> (D:\Projects\PN DocMS\index.js:44:8)
    at Domain.run (domain.js:363:14)
    at Timeout._onTimeout (D:\Projects\PN DocMS\index.js:24:5)
    at listOnTimeout (internal/timers.js:531:17)
    at processTimers (internal/timers.js:475:7)
Unexpected token ','
D:\Projects\PN DocMS\controllers\routeduty.js:57
        else  dbhandle.docEdit (res.id,req.body.newfile, dst + req.body.fileroute, , res.category, res.author, res.projects, res.deyt, res.size, res.content, routslipTemp, res.reference, res.enclosure, newComm);
                                                                                   ^

SyntaxError: Unexpected token ','
    at Module._compile (internal/modules/cjs/loader.js:895:18)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:995:10)
    at Module.load (internal/modules/cjs/loader.js:815:32)
    at Function.Module._load (internal/modules/cjs/loader.js:727:14)
    at Module.require (internal/modules/cjs/loader.js:852:19)
    at require (internal/modules/cjs/helpers.js:74:18)
    at module.exports (D:\Projects\PN DocMS\controllers\dasroyalty.js:6:19)
    at Domain.<anonymous> (D:\Projects\PN DocMS\index.js:44:8)
    at Domain.run (domain.js:363:14)
    at Timeout._onTimeout (D:\Projects\PN DocMS\index.js:24:5)
    at listOnTimeout (internal/timers.js:531:17)
    at processTimers (internal/timers.js:475:7)
The "dest" argument must be one of type string, Buffer, or URL. Received type number
TypeError [ERR_INVALID_ARG_TYPE]: The "dest" argument must be one of type string, Buffer, or URL. Received type number
    at Object.copyFile (fs.js:1769:10)
    at D:\Projects\PN DocMS\controllers\routeduty.js:183:16
    at Array.forEach (<anonymous>)
    at Object.exports.routNoRefEncIncoming (D:\Projects\PN DocMS\controllers\routeduty.js:178:16)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:220:33
    at D:\Projects\PN DocMS\controllers\monitoring.js:170:85
    at D:\Projects\PN DocMS\controllers\dbhandle.js:220:5
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
dataString.match is not a function
TypeError: dataString.match is not a function
    at decodeBase64Image (D:\Projects\PN DocMS\controllers\dasroyalty.js:62:30)
    at D:\Projects\PN DocMS\controllers\dasroyalty.js:133:36
    at FSReqCallback.readFileAfterClose [as oncomplete] (internal/fs/read_file_context.js:61:3)
data.split is not a function
TypeError: data.split is not a function
    at D:\Projects\PN DocMS\controllers\dasroyalty.js:126:41
    at FSReqCallback.readFileAfterClose [as oncomplete] (internal/fs/read_file_context.js:61:3)
data.replace is not a function
TypeError: data.replace is not a function
    at D:\Projects\PN DocMS\controllers\dasroyalty.js:126:37
    at FSReqCallback.readFileAfterClose [as oncomplete] (internal/fs/read_file_context.js:61:3)
decodedImg is not defined
ReferenceError: decodedImg is not defined
    at D:\Projects\PN DocMS\controllers\dasroyalty.js:128:77
    at FSReqCallback.readFileAfterClose [as oncomplete] (internal/fs/read_file_context.js:61:3)
Cannot read property 'comment' of null
TypeError: Cannot read property 'comment' of null
    at D:\Projects\PN DocMS\controllers\routeduty.js:56:18
    at Array.forEach (<anonymous>)
    at D:\Projects\PN DocMS\controllers\routeduty.js:54:20
    at D:\Projects\PN DocMS\controllers\dbhandle.js:370:15
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
ENOENT: no such file or directory, copyfile 'D:\NOC DF.pdf.sam.pdf' -> 'D:\Projects\PN DocMS\public\drive\PDF-temp\NOC DF.pdf.sam.pdf'
Error: ENOENT: no such file or directory, copyfile 'D:\NOC DF.pdf.sam.pdf' -> 'D:\Projects\PN DocMS\public\drive\PDF-temp\NOC DF.pdf.sam.pdf'
ENOENT: no such file or directory, copyfile 'D:\NOC DF.pdf.sam.pdf' -> 'D:\Projects\PN DocMS\public\drive\PDF-temp\NOC DF.pdf.sam.pdf'
Error: ENOENT: no such file or directory, copyfile 'D:\NOC DF.pdf.sam.pdf' -> 'D:\Projects\PN DocMS\public\drive\PDF-temp\NOC DF.pdf.sam.pdf'
ENOENT: no such file or directory, copyfile 'D:\NOC DF.pdf.sam.pdf.sam.pdf' -> 'D:\Projects\PN DocMS\public\drive\PDF-temp\NOC DF.pdf.sam.pdf.sam.pdf'
Error: ENOENT: no such file or directory, copyfile 'D:\NOC DF.pdf.sam.pdf.sam.pdf' -> 'D:\Projects\PN DocMS\public\drive\PDF-temp\NOC DF.pdf.sam.pdf.sam.pdf'
ENOENT: no such file or directory, copyfile 'D:\NOC DF.pdf.sam.pdf.sam.pdf.sam.pdf' -> 'D:\Projects\PN DocMS\public\drive\PDF-temp\NOC DF.pdf.sam.pdf.sam.pdf.sam.pdf'
Error: ENOENT: no such file or directory, copyfile 'D:\NOC DF.pdf.sam.pdf.sam.pdf.sam.pdf' -> 'D:\Projects\PN DocMS\public\drive\PDF-temp\NOC DF.pdf.sam.pdf.sam.pdf.sam.pdf'
Unexpected token _ in JSON at position 4
SyntaxError: Unexpected token _ in JSON at position 4
    at JSON.parse (<anonymous>)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:73:30
    at D:\Projects\PN DocMS\controllers\dbhandle.js:651:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot read property 'tostring' of undefined
TypeError: Cannot read property 'tostring' of undefined
    at D:\Projects\PN DocMS\controllers\dasincoming.js:73:36
    at D:\Projects\PN DocMS\controllers\dbhandle.js:651:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot read property 'toString' of undefined
TypeError: Cannot read property 'toString' of undefined
    at D:\Projects\PN DocMS\controllers\dasincoming.js:73:36
    at D:\Projects\PN DocMS\controllers\dbhandle.js:651:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot read property 'tostring' of undefined
TypeError: Cannot read property 'tostring' of undefined
    at D:\Projects\PN DocMS\controllers\dasincoming.js:73:36
    at D:\Projects\PN DocMS\controllers\dbhandle.js:651:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
directory is not defined
ReferenceError: directory is not defined
    at D:\Projects\PN DocMS\controllers\dassysadmin.js:222:24
    at D:\Projects\PN DocMS\controllers\dbhandle.js:515:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
activitylogsModel.findMany is not a function
TypeError: activitylogsModel.findMany is not a function
    at Object.exports.actlogFindAction (D:\Projects\PN DocMS\controllers\dbhandle.js:175:21)
    at D:\Projects\PN DocMS\controllers\dassysadmin.js:113:22
    at D:\Projects\PN DocMS\controllers\dbhandle.js:523:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.location (D:\Projects\PN DocMS\node_modules\express\lib\response.js:888:15)
    at ServerResponse.redirect (D:\Projects\PN DocMS\node_modules\express\lib\response.js:926:18)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:117:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.location (D:\Projects\PN DocMS\node_modules\express\lib\response.js:888:15)
    at ServerResponse.redirect (D:\Projects\PN DocMS\node_modules\express\lib\response.js:926:18)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:117:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.location (D:\Projects\PN DocMS\node_modules\express\lib\response.js:888:15)
    at ServerResponse.redirect (D:\Projects\PN DocMS\node_modules\express\lib\response.js:926:18)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:117:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.location (D:\Projects\PN DocMS\node_modules\express\lib\response.js:888:15)
    at ServerResponse.redirect (D:\Projects\PN DocMS\node_modules\express\lib\response.js:926:18)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:117:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.location (D:\Projects\PN DocMS\node_modules\express\lib\response.js:888:15)
    at ServerResponse.redirect (D:\Projects\PN DocMS\node_modules\express\lib\response.js:926:18)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:117:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.location (D:\Projects\PN DocMS\node_modules\express\lib\response.js:888:15)
    at ServerResponse.redirect (D:\Projects\PN DocMS\node_modules\express\lib\response.js:926:18)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:117:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.location (D:\Projects\PN DocMS\node_modules\express\lib\response.js:888:15)
    at ServerResponse.redirect (D:\Projects\PN DocMS\node_modules\express\lib\response.js:926:18)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:117:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.location (D:\Projects\PN DocMS\node_modules\express\lib\response.js:888:15)
    at ServerResponse.redirect (D:\Projects\PN DocMS\node_modules\express\lib\response.js:926:18)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:117:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.location (D:\Projects\PN DocMS\node_modules\express\lib\response.js:888:15)
    at ServerResponse.redirect (D:\Projects\PN DocMS\node_modules\express\lib\response.js:926:18)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:117:27
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
express is not defined
ReferenceError: express is not defined
    at D:\Projects\PN DocMS\controllers\login.js:43:28
    at D:\Projects\PN DocMS\controllers\dbhandle.js:688:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
express is not defined
ReferenceError: express is not defined
    at D:\Projects\PN DocMS\controllers\login.js:43:28
    at D:\Projects\PN DocMS\controllers\dbhandle.js:688:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
express is not defined
ReferenceError: express is not defined
    at D:\Projects\PN DocMS\controllers\login.js:44:28
    at D:\Projects\PN DocMS\controllers\dbhandle.js:688:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
express is not defined
ReferenceError: express is not defined
    at D:\Projects\PN DocMS\controllers\login.js:42:28
    at D:\Projects\PN DocMS\controllers\dbhandle.js:688:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
    at runNextTicks (internal/process/task_queues.js:62:3)
    at processImmediate (internal/timers.js:412:9)
    at process.topLevelDomainCallback (domain.js:130:23)
app.static is not a function
TypeError: app.static is not a function
    at D:\Projects\PN DocMS\index.js:69:34
    at D:\Projects\PN DocMS\controllers\dbhandle.js:688:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
ENOENT: no such file or directory, mkdir 'public/drive/n6b/'
Error: ENOENT: no such file or directory, mkdir 'public/drive/n6b/'
    at Object.mkdirSync (fs.js:823:3)
    at D:\Projects\PN DocMS\controllers\login.js:98:41
    at D:\Projects\PN DocMS\controllers\dbhandle.js:524:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot read property 'forEach' of undefined
TypeError: Cannot read property 'forEach' of undefined
    at Object.exports.checkPermission (D:\Projects\PN DocMS\controllers\utilsdocms.js:114:9)
    at D:\Projects\PN DocMS\controllers\dasmonitor.js:120:38
    at FSReqCallback.oncomplete (fs.js:146:23)
await is only valid in async function
D:\Projects\PN DocMS\controllers\pdflib.js:70
        const pdfDoc = await PDFDocument.load(existingPdfBytes);
                       ^^^^^

SyntaxError: await is only valid in async function
    at Module._compile (internal/modules/cjs/loader.js:895:18)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:995:10)
    at Module.load (internal/modules/cjs/loader.js:815:32)
    at Function.Module._load (internal/modules/cjs/loader.js:727:14)
    at Module.require (internal/modules/cjs/loader.js:852:19)
    at require (internal/modules/cjs/helpers.js:74:18)
    at module.exports (D:\Projects\PN DocMS\controllers\dasroyalty.js:20:18)
    at D:\Projects\PN DocMS\index.js:51:7
    at D:\Projects\PN DocMS\controllers\dbhandle.js:697:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot read property 'includes' of undefined
TypeError: Cannot read property 'includes' of undefined
    at D:\Projects\PN DocMS\controllers\dastransact.js:114:26
    at D:\Projects\PN DocMS\controllers\dbhandle.js:195:5
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\helpers\query\completeMany.js:35:39
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot read property 'includes' of undefined
TypeError: Cannot read property 'includes' of undefined
    at D:\Projects\PN DocMS\controllers\dastransact.js:114:26
    at D:\Projects\PN DocMS\controllers\dbhandle.js:195:5
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\helpers\query\completeMany.js:35:39
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot set headers after they are sent to the client
Error [ERR_HTTP_HEADERS_SENT]: Cannot set headers after they are sent to the client
    at ServerResponse.setHeader (_http_outgoing.js:485:11)
    at ServerResponse.header (D:\Projects\PN DocMS\node_modules\express\lib\response.js:771:10)
    at ServerResponse.send (D:\Projects\PN DocMS\node_modules\express\lib\response.js:170:12)
    at ServerResponse.json (D:\Projects\PN DocMS\node_modules\express\lib\response.js:267:15)
    at D:\Projects\PN DocMS\controllers\dastransact.js:118:15
    at D:\Projects\PN DocMS\controllers\dbhandle.js:195:5
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\helpers\query\completeMany.js:35:39
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
Cannot find module '../dist/helpers'
Require stack:
- D:\Projects\PN DocMS\controllers\dasroyalty.js
- D:\Projects\PN DocMS\index.js
Error: Cannot find module '../dist/helpers'
Require stack:
- D:\Projects\PN DocMS\controllers\dasroyalty.js
- D:\Projects\PN DocMS\index.js
    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:797:15)
    at Function.Module._load (internal/modules/cjs/loader.js:690:27)
    at Module.require (internal/modules/cjs/loader.js:852:19)
    at require (internal/modules/cjs/helpers.js:74:18)
    at D:\Projects\PN DocMS\controllers\dasroyalty.js:43:75
    at D:\Projects\PN DocMS\controllers\dbhandle.js:705:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
    at runNextTicks (internal/process/task_queues.js:62:3)
    at processImmediate (internal/timers.js:412:9)
    at process.topLevelDomainCallback (domain.js:130:23)
Cannot find module '../dist/helpers'
Require stack:
- D:\Projects\PN DocMS\controllers\dasroyalty.js
- D:\Projects\PN DocMS\index.js
Error: Cannot find module '../dist/helpers'
Require stack:
- D:\Projects\PN DocMS\controllers\dasroyalty.js
- D:\Projects\PN DocMS\index.js
    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:797:15)
    at Function.Module._load (internal/modules/cjs/loader.js:690:27)
    at Module.require (internal/modules/cjs/loader.js:852:19)
    at require (internal/modules/cjs/helpers.js:74:18)
    at D:\Projects\PN DocMS\controllers\dasroyalty.js:43:75
    at D:\Projects\PN DocMS\controllers\dbhandle.js:705:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
    at runNextTicks (internal/process/task_queues.js:62:3)
    at processImmediate (internal/timers.js:412:9)
    at process.topLevelDomainCallback (domain.js:130:23)
Cannot find module '../dist/helpers'
Require stack:
- D:\Projects\PN DocMS\controllers\dasroyalty.js
- D:\Projects\PN DocMS\index.js
Error: Cannot find module '../dist/helpers'
Require stack:
- D:\Projects\PN DocMS\controllers\dasroyalty.js
- D:\Projects\PN DocMS\index.js
    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:797:15)
    at Function.Module._load (internal/modules/cjs/loader.js:690:27)
    at Module.require (internal/modules/cjs/loader.js:852:19)
    at require (internal/modules/cjs/helpers.js:74:18)
    at D:\Projects\PN DocMS\controllers\dasroyalty.js:43:75
    at D:\Projects\PN DocMS\controllers\dbhandle.js:705:7
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2869:28
    at processTicksAndRejections (internal/process/task_queues.js:75:11)
    at runNextTicks (internal/process/task_queues.js:62:3)
    at processImmediate (internal/timers.js:412:9)
    at process.topLevelDomainCallback (domain.js:130:23)
ENOENT: no such file or directory, open 'public/drive/N6B/empty'
Error: ENOENT: no such file or directory, open 'public/drive/N6B/empty'
    at Object.openSync (fs.js:440:3)
    at Object.readFileSync (fs.js:342:35)
    at Object.exports.verifySign (D:\Projects\PN DocMS\controllers\utilsdocms.js:67:30)
    at D:\Projects\PN DocMS\controllers\dasincoming.js:435:46
    at D:\Projects\PN DocMS\controllers\monitoring.js:169:14
    at D:\Projects\PN DocMS\controllers\dbhandle.js:247:5
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\model.js:4827:16
    at D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:4390:12
    at model.Query.Query._completeOne (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2074:12)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mongoose\lib\query.js:2136:10)
    at Immediate.<anonymous> (D:\Projects\PN DocMS\node_modules\mquery\lib\utils.js:116:16)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
